<Controls:MetroWindow x:Class="ExplorerWindowCleaner.MainWindow"
        xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Explorer Window Cleaner" Height="350" Width="525" Icon="icon.ico"
        GlowBrush="{DynamicResource AccentColorBrush}"
        ShowMaxRestoreButton="False"
        ShowIconOnTitleBar="False">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Horizontal" Background="#333333">
            <TextBlock Foreground="WhiteSmoke" Text="{Binding NowWindowCount, StringFormat= NowWindows: {0}}" Margin="5"  Padding="5,0,0,0"></TextBlock>
            <TextBlock Foreground="WhiteSmoke" Text="{Binding MaxWindowCount, StringFormat= MaxOpenWindows: {0}}" Margin="5" Padding="15,0,0,0"></TextBlock>
            <TextBlock Foreground="WhiteSmoke" Text="{Binding TotalClosedWindow, StringFormat= TotalClosedWindows: {0}}" Margin="5" Padding="15,0,0,0"></TextBlock>
        </StackPanel>
        <DataGrid Grid.Row="1" ItemsSource="{Binding Explorers}" SelectedItem="{Binding CurrentExplorer}" AutoGenerateColumns="False">
            <DataGrid.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Copy LocalPath" Click="MenuItem_OnClick">
                        <MenuItem.Icon>
                            <Image Source="Resources/copyclipboard.png" Stretch="Uniform"/>
                        </MenuItem.Icon>
                    </MenuItem>
                </ContextMenu>
            </DataGrid.ContextMenu>
            <DataGrid.RowStyle>
                <Style TargetType="{x:Type DataGridRow}" BasedOn="{StaticResource MetroDataGridRow}">
                    <EventSetter Event="PreviewMouseDoubleClick" Handler="DataGrid_OnDoubleClick" />
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.Columns>
                <DataGridTextColumn  Header="LastUpdate" Binding="{Binding LastUpdate, Mode=OneWay}" Width="140"></DataGridTextColumn>
                <DataGridTextColumn  Header="Directory" Binding="{Binding LocationName, Mode=OneWay}" Width="*"></DataGridTextColumn>
                <DataGridTextColumn  Header="LocalPath" Binding="{Binding LocalPath, Mode=OneWay}" Width="2*"></DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Controls:MetroWindow>